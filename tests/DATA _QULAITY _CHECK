USE Datawarehouse

PRINT('===========CRM_TABLES====================')
PRINT('===========crm_cust_info=============')
SELECT * FROM bronze.crm_cust_info

SELECT cst_id ,COUNT(*)
FROM bronze.crm_cust_info
GROUP BY cst_id
HAVING COUNT(*) > 1  OR cst_id IS NULL -- Having Duplicate CST_ID 

SELECT 
cst_firstname
FROM bronze.crm_cust_info
WHERE cst_firstname != TRIM(cst_firstname) ----> Find Spaces in cst_firstname

SELECT 
cst_lastname
FROM bronze.crm_cust_info
WHERE cst_lastname != TRIM(cst_lastname) ----> Find Spaces in cst_lastname

SELECT DISTINCT(cst_gndr)
FROM bronze.crm_cust_info  --> F,M,NULL

SELECT DISTINCT(cst_marital_status)
FROM bronze.crm_cust_info --> S,NULL,M

SELECT DISTINCT(cst_create_date)
FROM bronze.crm_cust_info 
WHERE cst_create_date > GETDATE() --> There is Futered Created Date

SELECT cst_id ,COUNT(*)
FROM silver.crm_cust_info
GROUP BY cst_id
HAVING COUNT(*) != 1  OR cst_id IS NULL -- Having Duplicate CST_ID 

SELECT 
cst_firstname
FROM silver.crm_cust_info
WHERE cst_firstname != TRIM(cst_firstname) ----> Find Spaces in cst_firstname

SELECT 
cst_lastname
FROM silver.crm_cust_info
WHERE cst_lastname != TRIM(cst_lastname) ----> Find Spaces in cst_lastname

SELECT DISTINCT(cst_gndr)
FROM silver.crm_cust_info  --> F,M,NULL

SELECT DISTINCT(cst_marital_status)
FROM silver.crm_cust_info --> S,NULL,M

SELECT DISTINCT(cst_create_date)
FROM silver.crm_cust_info 
WHERE cst_create_date > GETDATE() --> There is Futered Created Date


PRINT('===========crm_prd_info=============')

SELECT * FROM silver.crm_prd_info

SELECT prd_id , COUNT(*)
FROM silver.crm_prd_info 
GROUP BY prd_id
HAVING COUNT(prd_id) != 1 OR prd_id IS NULL --> DUPLICATES IN ID

SELECT prd_cost
FROM silver.crm_prd_info 
WHERE prd_cost <= 0 OR prd_cost IS NULL --> COST QUALITY IS THERE ANY NEGATIVE VALUE OR NULLS

SELECT DISTINCT(prd_line)
FROM silver.crm_prd_info --> STANDRIZATIONS

PRINT('===========crm_sales_details=============')

SELECT * FROM silver.crm_sales_details

SELECT sls_prd_key 
FROM silver.crm_sales_details
WHERE sls_prd_key NOT IN (SELECT prd_key FROM silver.crm_prd_info)

SELECT sls_cust_id
FROM silver.crm_sales_details
WHERE sls_cust_id NOT IN (SELECT cst_id FROM silver.crm_cust_info)

SELECT sls_order_dt
FROM silver.crm_sales_details
WHERE sls_order_dt = 0

SELECT sls_order_dt
FROM silver.crm_sales_details
WHERE LEN(sls_due_dt) < 8  

SELECT sls_order_dt
FROM bronze.crm_sales_details
WHERE LEN(sls_due_dt) > 8  


SELECT sls_quantity 
FROM silver.crm_sales_details
where sls_quantity = 0

SELECT *
FROM silver.crm_sales_details
WHERE sls_order_dt > sls_ship_dt or sls_order_dt > sls_due_dt

SELECT DISTINCT
sls_sales,
sls_quantity,
sls_price
FROM silver.crm_sales_details
where sls_sales <= 0 OR sls_sales IS NULL 
OR sls_quantity <= 0 OR sls_quantity IS NULL 
OR sls_price <= 0 OR sls_price IS NULL 
OR sls_price != sls_quantity * sls_sales
ORDER BY sls_quantity,sls_sales,sls_price

PRINT('===========ERP_TABLES================')
PRINT('===========erp_cust_az12=============')

SELECT * FROM bronze.erp_cust_az12

SELECT cid , count(*)
FROM bronze.erp_cust_az12
GROUP BY cid
HAVING COUNT(*) > 1  OR cid IS NULL

SELECT cid 
FROM bronze.erp_cust_az12 
WHERE cid NOT IN (SELECT cst_key FROM silver.crm_cust_info )

SELECT bdate
FROM bronze.erp_cust_az12
WHERE bdate > GETDATE()

SELECT DISTINCT(gen)
FROM bronze.erp_cust_az12

PRINT('===========erp_loc_a101=============')
SELECT * FROM silver.erp_loc_a101

SELECT cid , count(*)
FROM silver.erp_loc_a101
GROUP BY cid
HAVING COUNT(*) > 1  OR cid IS NULL

SELECT REPLACE(cid,'-','') AS cid ,cntry
FROM silver.erp_loc_a101

SELECT DISTINCT(cntry)
FROM silver.erp_loc_a101

PRINT('===========erp_px_cat_g1v2=============')

SELECT * FROM bronze.erp_px_cat_g1v2

SELECT DISTINCT(subcat)
FROM bronze.erp_px_cat_g1v2

SELECT DISTINCT(cat)
FROM bronze.erp_px_cat_g1v2

SELECT DISTINCT(MAINTENANCE)
FROM bronze.erp_px_cat_g1v2

SELECT id 
FROM bronze.erp_px_cat_g1v2
WHERE id NOT IN (SELECT cat_id FROM silver.crm_prd_info )








